<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns="http://www.w3.org/1999/html">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>品牌排序</title>
    <link href="../../web-resource/css/common.css" rel="stylesheet" />
    <link href="../../web-resource/css/pages/brand.css" rel="stylesheet" />
    <script src="../../web-resource/js/jquery/jquery.1.8.1.js"  language="javascript"></script>
</head>

<body>
    <!--start header-->
    <!--end header-->
    <!--start body-->
    <div class="body m-w980p m-mt10p">
    <div class="body-nav">
        <ul class="m-clear">
            <li><a>广告页面</a></li>
            <li><a>站内信</a></li>
            <li><a>网站地图</a></li>
            <li><a class="current-chose">品牌排序</a></li>
        </ul>
    </div>
      <!--start form-->
      <div class="reorder">
        <ul class="bra-camp m-clear">
        	<div class="m-hide J-first"></div>
        	<li>
            <a href="http://www.xlbuy365.com/p/100000/" target="_blank">
                <img src="http://f.xlbuy365.com/file/media/thumb/uhome/brand/2013/04/25/73d59ff1-e710-42bd-b242-001f245ac3f0.jpg_t21.jpg" alt="汉麻世家" width="94" height="48">
            </a>
            <div class="brand-reorder">
            	<div class="reorder-bg"></div>
            	<i class="pre"></i>
            		<input type="text" class="reorder-val" value="1" id="brand-1" data_id="1" />
            	<i class="next"></i>
            </div>
        </ul>
        </li>
      </div>
      <!--所有品牌-->
      <div class="all-brand">
        <ul class="bra-camp m-clear">
            <li>
                <a href="http://www.xlbuy365.com/p/100000/" target="_blank">
                    <img src="http://f.xlbuy365.com/file/media/thumb/uhome/brand/2013/04/25/73d59ff1-e710-42bd-b242-001f245ac3f0.jpg_t21.jpg" alt="汉麻世家" width="94" height="48">
                </a>
                <input type="checkbox" class="brand-checked" checked="checked" />
            </li>
          	<li>
                <a href="http://www.xlbuy365.com/p/100001/" target="_blank">
                    <img src="http://f.xlbuy365.com/file/media/thumb/uhome/brand/2013/04/25/11550238-b510-4f16-8f88-70797037b9bc.jpg_t21.jpg" alt="本草堂" width="94" height="48">
                </a>
                <input type="checkbox" class="brand-checked" />
            </li>
          	<li>
                <a href="http://www.xlbuy365.com/p/100002/" target="_blank">
                    <img src="http://f.xlbuy365.com/file/media/thumb/uhome/brand/2013/04/25/579cae5b-11f0-4daa-a0b6-104bd9bcd181.jpg_t21.jpg" alt="朗白先生" width="94" height="48">
                </a>
                <input type="checkbox" class="brand-checked" />
            </li>
          	<li>
                <a href="http://www.xlbuy365.com/p/100003/" target="_blank">
                    <img src="http://f.xlbuy365.com/file/media/thumb/uhome/brand/2013/04/25/66a4e2bb-34b8-4188-9945-9b7b0c38c303.jpg_t21.jpg" alt="香必飘" width="94" height="48">
                </a>
                <input type="checkbox" class="brand-checked" />
            </li>
          	<li>
                <a href="http://www.xlbuy365.com/p/100004/" target="_blank">
                    <img src="http://f.xlbuy365.com/file/media/thumb/uhome/brand/2013/04/25/63778416-6dad-490a-8dd2-ce6779182eb6.jpg_t21.jpg" alt="莱唯德" width="94" height="48">
                </a>
                <input type="checkbox" class="brand-checked" />
            </li>
          	<li>
                <a href="http://www.xlbuy365.com/p/100005/" target="_blank">
                    <img src="http://f.xlbuy365.com/file/media/thumb/uhome/brand/2013/04/25/d7668ecd-b256-4c94-8d70-c30e65a41f41.jpg_t21.jpg" alt="露华浓" width="94" height="48">
                </a>
                <input type="checkbox" class="brand-checked" />
            </li>
          	<li>
                <a href="http://www.xlbuy365.com/p/100006/" target="_blank">
                    <img src="http://f.xlbuy365.com/file/media/thumb/uhome/brand/2013/04/25/caf841e2-225d-46ad-bf8c-a446b7011d92.jpg_t21.jpg" alt="瑞纽慈" width="94" height="48">
                </a>
                <input type="checkbox" class="brand-checked" />
            </li>
          	<li>
                <a href="http://www.xlbuy365.com/p/100007/" target="_blank">
                    <img src="http://f.xlbuy365.com/file/media/thumb/uhome/brand/2013/05/13/88a4d162-266b-4934-9ae4-3f4ff2d281cc.jpg_t21.jpg" alt="御灵珠宝" width="94" height="48">
                </a>
                <input type="checkbox" class="brand-checked" />
            </li>
          	<li>
                <a href="http://www.xlbuy365.com/p/100008/" target="_blank">
                    <img src="http://f.xlbuy365.com/file/media/thumb/uhome/brand/2013/05/16/6801acea-f86c-417e-97ef-e9c3e9eb99ba.jpg_t21.jpg" alt="芝宝" width="94" height="48">
                </a>
                <input type="checkbox" class="brand-checked" />
            </li>
          	<li>
                <a href="http://www.xlbuy365.com/p/100009/" target="_blank">
                    <img src="http://f.xlbuy365.com/file/media/thumb/uhome/brand/2013/05/30/7dac5446-e032-4f27-8f62-578fe62ec1ef.jpg_t21.jpg" alt="炫美家纺" width="94" height="48">
                </a>
                <input type="checkbox" class="brand-checked" />
            </li>
          	<li>
                <a href="http://www.xlbuy365.com/p/100010/" target="_blank">
                    <img src="http://f.xlbuy365.com/file/media/thumb/uhome/brand/2013/05/30/b086dc73-ea5b-4ffa-9f4e-bd2fc2384892.jpg_t21.jpg" alt="欧弗女装" width="94" height="48">
                </a>
                <input type="checkbox" class="brand-checked" />
            </li>
          	<li>
                <a href="http://www.xlbuy365.com/p/100011/" target="_blank">
                    <img src="http://f.xlbuy365.com/file/media/thumb/uhome/brand/2013/06/08/a5d72fc1-91c4-4549-bfad-6dce036513bb.jpg_t21.jpg" alt="手机工坊" width="94" height="48">
                </a>
                <input type="checkbox" class="brand-checked" />
            </li>
          	<li>
                <a href="http://www.xlbuy365.com/p/100012/" target="_blank">
                    <img src="http://f.xlbuy365.com/file/media/thumb/uhome/brand/2013/06/09/7b067465-6bda-4ff3-a034-417e66c097ed.jpg_t21.jpg" alt="迈克·菲恩" width="94" height="48">
                </a>
                <input type="checkbox" class="brand-checked" />
            </li>
          	<li>
                <a href="http://www.xlbuy365.com/p/100013/" target="_blank">
                    <img src="http://f.xlbuy365.com/file/media/thumb/uhome/brand/2013/06/09/89856d4b-407b-4119-a87f-bda6edf84c52.jpg_t21.jpg" alt="REMAX" width="94" height="48">
                </a>
                <input type="checkbox" class="brand-checked" />
            </li>
          	<li>
                <a href="http://www.xlbuy365.com/p/100014/" target="_blank">
                    <img src="http://f.xlbuy365.com/file/media/thumb/uhome/brand/2013/06/14/c0a9a7da-4864-48e7-abf4-f8aa076896c6.jpg_t21.jpg" alt="逸轩家纺" width="94" height="48">
                </a>
                <input type="checkbox" class="brand-checked" />
            </li>
          	<li>
                <a href="http://www.xlbuy365.com/p/100015/" target="_blank">
                    <img src="http://f.xlbuy365.com/file/media/thumb/uhome/brand/2013/06/18/8dc0151a-f579-4f7b-9c46-c22e1c74a8da.jpg_t21.jpg" alt="乐扣乐扣" width="94" height="48">
                </a>
                <input type="checkbox" class="brand-checked" />
            </li>
            <li>
                <a href="http://www.xlbuy365.com/p/100000/" target="_blank">
                    <img src="http://f.xlbuy365.com/file/media/thumb/uhome/brand/2013/04/25/73d59ff1-e710-42bd-b242-001f245ac3f0.jpg_t21.jpg" alt="汉麻世家" width="94" height="48">
                </a>
                <input type="checkbox" class="brand-checked" />
            </li>
          	<li>
                <a href="http://www.xlbuy365.com/p/100001/" target="_blank">
                    <img src="http://f.xlbuy365.com/file/media/thumb/uhome/brand/2013/04/25/11550238-b510-4f16-8f88-70797037b9bc.jpg_t21.jpg" alt="本草堂" width="94" height="48">
                </a>
                <input type="checkbox" class="brand-checked" />
            </li>
          	<li>
                <a href="http://www.xlbuy365.com/p/100002/" target="_blank">
                    <img src="http://f.xlbuy365.com/file/media/thumb/uhome/brand/2013/04/25/579cae5b-11f0-4daa-a0b6-104bd9bcd181.jpg_t21.jpg" alt="朗白先生" width="94" height="48">
                </a>
                <input type="checkbox" class="brand-checked" />
            </li>
          	<li>
                <a href="http://www.xlbuy365.com/p/100003/" target="_blank">
                    <img src="http://f.xlbuy365.com/file/media/thumb/uhome/brand/2013/04/25/66a4e2bb-34b8-4188-9945-9b7b0c38c303.jpg_t21.jpg" alt="香必飘" width="94" height="48">
                </a>
                <input type="checkbox" class="brand-checked" />
            </li>
          	<li>
                <a href="http://www.xlbuy365.com/p/100004/" target="_blank">
                    <img src="http://f.xlbuy365.com/file/media/thumb/uhome/brand/2013/04/25/63778416-6dad-490a-8dd2-ce6779182eb6.jpg_t21.jpg" alt="莱唯德" width="94" height="48">
                </a>
                <input type="checkbox" class="brand-checked" />
            </li>
          	<li>
                <a href="http://www.xlbuy365.com/p/100005/" target="_blank">
                    <img src="http://f.xlbuy365.com/file/media/thumb/uhome/brand/2013/04/25/d7668ecd-b256-4c94-8d70-c30e65a41f41.jpg_t21.jpg" alt="露华浓" width="94" height="48">
                </a>
                <input type="checkbox" class="brand-checked" />
            </li>
          	<li>
                <a href="http://www.xlbuy365.com/p/100006/" target="_blank">
                    <img src="http://f.xlbuy365.com/file/media/thumb/uhome/brand/2013/04/25/caf841e2-225d-46ad-bf8c-a446b7011d92.jpg_t21.jpg" alt="瑞纽慈" width="94" height="48">
                </a>
                <input type="checkbox" class="brand-checked" />
            </li>
          	<li>
                <a href="http://www.xlbuy365.com/p/100007/" target="_blank">
                    <img src="http://f.xlbuy365.com/file/media/thumb/uhome/brand/2013/05/13/88a4d162-266b-4934-9ae4-3f4ff2d281cc.jpg_t21.jpg" alt="御灵珠宝" width="94" height="48">
                </a>
                <input type="checkbox" class="brand-checked" />
            </li>
          	<li>
                <a href="http://www.xlbuy365.com/p/100008/" target="_blank">
                    <img src="http://f.xlbuy365.com/file/media/thumb/uhome/brand/2013/05/16/6801acea-f86c-417e-97ef-e9c3e9eb99ba.jpg_t21.jpg" alt="芝宝" width="94" height="48">
                </a>
                <input type="checkbox" class="brand-checked" />
            </li>
          	<li>
                <a href="http://www.xlbuy365.com/p/100009/" target="_blank">
                    <img src="http://f.xlbuy365.com/file/media/thumb/uhome/brand/2013/05/30/7dac5446-e032-4f27-8f62-578fe62ec1ef.jpg_t21.jpg" alt="炫美家纺" width="94" height="48">
                </a>
                <input type="checkbox" class="brand-checked" />
            </li>
          	<li>
                <a href="http://www.xlbuy365.com/p/100010/" target="_blank">
                    <img src="http://f.xlbuy365.com/file/media/thumb/uhome/brand/2013/05/30/b086dc73-ea5b-4ffa-9f4e-bd2fc2384892.jpg_t21.jpg" alt="欧弗女装" width="94" height="48">
                </a>
                <input type="checkbox" class="brand-checked" />
            </li>
          	<li>
                <a href="http://www.xlbuy365.com/p/100011/" target="_blank">
                    <img src="http://f.xlbuy365.com/file/media/thumb/uhome/brand/2013/06/08/a5d72fc1-91c4-4549-bfad-6dce036513bb.jpg_t21.jpg" alt="手机工坊" width="94" height="48">
                </a>
                <input type="checkbox" class="brand-checked" />
            </li>
          	<li>
                <a href="http://www.xlbuy365.com/p/100012/" target="_blank">
                    <img src="http://f.xlbuy365.com/file/media/thumb/uhome/brand/2013/06/09/7b067465-6bda-4ff3-a034-417e66c097ed.jpg_t21.jpg" alt="迈克·菲恩" width="94" height="48">
                </a>
                <input type="checkbox" class="brand-checked" />
            </li>
          	<li>
                <a href="http://www.xlbuy365.com/p/100013/" target="_blank">
                    <img src="http://f.xlbuy365.com/file/media/thumb/uhome/brand/2013/06/09/89856d4b-407b-4119-a87f-bda6edf84c52.jpg_t21.jpg" alt="REMAX" width="94" height="48">
                </a>
                <input type="checkbox" class="brand-checked" />
            </li>
          	<li>
                <a href="http://www.xlbuy365.com/p/100014/" target="_blank">
                    <img src="http://f.xlbuy365.com/file/media/thumb/uhome/brand/2013/06/14/c0a9a7da-4864-48e7-abf4-f8aa076896c6.jpg_t21.jpg" alt="逸轩家纺" width="94" height="48">
                </a>
                <input type="checkbox" class="brand-checked" />
            </li>
          	<li>
                <a href="http://www.xlbuy365.com/p/100015/" target="_blank">
                    <img src="http://f.xlbuy365.com/file/media/thumb/uhome/brand/2013/06/18/8dc0151a-f579-4f7b-9c46-c22e1c74a8da.jpg_t21.jpg" alt="乐扣乐扣" width="94" height="48">
                </a>
                <input type="checkbox" class="brand-checked" />
            </li>
        </ul>
      </div>
      <input type="button" class="m-btn m-mt10p J-save" value="保存" />
     	<!--end form-->
    </div>
    <!--end body-->
    <!--start footer-->
    <!--end footer-->
<script>
 
	function checkNum(){
		//alert($("#brandIds").val());
		var len = $(".reorder li").length;
		if(len<=40){
			 return true;
		}else 
			alert("最多选择40个品牌");
			return false;
	}
	
	$(document).ready(function(){
		$(".all-brand li").each(function(i){
			var $this = $(this),
				$check = $this.find(".brand-checked"),
				i = $(this).index()+1,
				a_href = $this.find("a").attr("href"),	
				img_url = $this.find("img").attr("src"),
				img_alt = $this.find("img").attr("alt");
				$check.on("click",function(){
					var flag = $check.attr("checked");
					if(flag){
						var brandId = $check.attr("value");
						var html = '<li id="'+ brandId +'"><a href="'+a_href+'" target="_blank"><img src="'+img_url+'" alt="'+img_alt+'" width="94" height="48"></a>';
				        html +='<div class="brand-reorder"><div class="reorder-bg"></div><i class="pre"></i><input type="text" class="reorder-val" value="'+i+'" id="brand-'+i+'" />';
				        html +='<i class="next"></i></div></li>';
						$(".reorder ul").append(html);
						reorderId();
					}else{
						$("input[id = brand-"+i+"]").parents("li").remove();
						reorderId();
					}
				});
		});
			var $li = $(".reorder li"),
				$val = $(".reorder-val");
			$li.live("mouseenter",function(){
				$(this).addClass("hover");
			});
			$li.live("mouseleave",function(){
				var $this = $(this),
					$val = $(this).find(".reorder-val");
				if(!$val.hasClass("focus")){
					$this.removeClass("hover");
				}
			});
			$val.live("focus",function(){
				$(this).addClass("focus");
			});
			$val.live("blur",function(){
				var $this = $(this),
					$this_val = parseInt($this.val()),
					$this_data_id = parseInt($this.attr("data_id"));
					$this_li = $this.parents("li");
				if($this_val<1||$this_val>40||!$this_val){
					alert("请输入1-40之间的数字");
					$this.val("").focus();
				}else{
					$this.removeClass("focus");
					$this_li.removeClass("hover");
					if($this_val>$this_data_id){
						insert($this_val,$this_li,true);
					}else if($this_val<$this_data_id){
						insert($this_val,$this_li,false);
					}
				}
			});
			//修改顺序函数
			var insert=function(val,li_html,isAfter){
				var $pre_li,
					len = $(".reorder li").length,
					$this_ul = $(".reorder ul");
				if(val > len){
					$this_ul.append(li_html);
				}else{
					if(1 == val){
						var $pre_li = $(".J-first");
					}else	if(isAfter){
						$pre_li = $(".reorder-val[data_id="+val+"]").parents("li");
					}else{
						$pre_li = $(".reorder-val[data_id="+(val-1)+"]").parents("li");
					}
					$($pre_li).after(li_html);
				}
				reorderId();
			}
			//data_id排序
			var reorderId = function(){
				var bandIds ="";
				$(".reorder li").each(function(){
					bandIds += 	$(this).attr('id') +",";
					var i = parseInt($(this).index());
					$(this).find(".reorder-val").attr("data_id",i);
					if(i>0&&i<41){
						$(this).find(".reorder-val").val(i);
					}else{
						$(this).find(".reorder-val").val("");
					}
				});
				//alert(bandIds);
				$("#brandIds").val(bandIds);
				 
			}
			//品牌向前排序
  		$(".pre").live("click",function(){
  			var $this_temp = $(this).parents("li"),
  				$this_input =$(this).next(".reorder-val"),
  				$this_val = $this_input.val(),
  				$pre_temp = $($this_temp).prev("li");
  			if($pre_temp.get(0)){
  				var $pre_input = $pre_temp.find(".reorder-val"),
  					$pre_val = $pre_input.val();
  				$($pre_temp).before($this_temp);
  				$pre_input.val($this_val);
  				$this_input.val($pre_val);
  				reorderId();
  			}
  		});
  		//品牌向后排序
  		$(".next").live("click",function(){
  			var $this_temp = $(this).parents("li"),
  				$this_input =$(this).prev(".reorder-val"),
  				$this_val = $this_input.val(),
  				$next_temp = $($this_temp).next("li");
  			if($next_temp.get(0)){
  				var $next_temp_input = $next_temp.find(".reorder-val"),
  					$next_temp_val = $next_temp_input.val();
  				$($next_temp).after($this_temp);
  				$next_temp_input.val($this_val);
  				$this_input.val($next_temp_val);
  				reorderId();
  			}
  		});
	});
</script>
</body>
</html>
